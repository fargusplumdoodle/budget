{% extends 'api/base_templates/base_no_sidebar.html' %}
{% block content %}
    {% load static %}
    <script src="{% static "js/Chart.min.js" %}"></script>
    <script src="{% static "js/graph_history.js" %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static "css/graph_history_page.css" %}">

    {# Form for getting graph data #}
    {% csrf_token %}
    <div id="graph-input" class="container">
        <div class="row">
            <div  class="col-sm-6">
                <label for="id_start">Start Date:</label>
                <input class="btn form-input" type="date" min="2019-10-01" max="2077-07-31" id="id_start">
                <br>
                <label for="id_end">End Date:</label>
                <input class="btn form-input"type="date" min="2019-10-01" max="2077-07-31" id="id_end">
            </div>
            <div class="col-sm-6">
                <label for="id_budgets">Budgets:</label>
                <select class="btn form-input" id="id_budgets" name="budgets" required="" multiple="">
                    {% for budget in budgets %}
                        <option value="{{ budget }}" selected="selected">{{ budget }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <button class="btn-success btn" id="graph-button">Graph</button>
        <hr/>

        {# Defining canvas for chart #}
        <div id="chart-container">
        <canvas id="myChart" width="400" height="400"></canvas>
        </div>
        <script>
            // GLOBAL VARIABLES
            const GRAPH_HISTORY_API_URL = '{% url 'api_graph_history' %}';

            // setting onclick for form
            document.getElementById("graph-button").onclick = () => {
                renderGraph(GRAPH_HISTORY_API_URL);
            };

            window.onload = function () {
                set_initial_dates(GRAPH_HISTORY_API_URL);
            };

        </script>

        <div id="stats_container">
            <h2>Stats</h2>
            <table id="statslist">
                <tr>
                    <th>Field</th>
                    <th>Value</th>
                </tr>
            </table>
            <hr/>
        </div>
{% endblock %}